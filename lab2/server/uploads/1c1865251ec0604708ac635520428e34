<h2>–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h2>

<% if (tasks.length === 0) { %>
  <p>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç.</p>
<% } else { %>
  <form class="filter-form" method="GET" action="/tasks">
    <label>
      –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É:
      <select name="status" onchange="this.form.submit()">
        <option value="">–í—Å–µ</option>
        <option value="todo" <%= status === 'todo' ? 'selected' : '' %>>–ù–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å</option>
        <option value="current" <%= status === 'current' ? 'selected' : '' %>>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
        <option value="done" <%= status === 'done' ? 'selected' : '' %>>–ì–æ—Ç–æ–≤–æ</option>
      </select>
    </label>
  </form>

  <table>
    <thead>
      <tr>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–°—Ä–æ–∫</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      <% tasks.forEach(task => { %>
      <tr>
        <td><%= task.title %></td>
        <td>
          <span class="status <%= task.status %>">
            <%= task.status === 'todo' ? '–ù–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å' : task.status === 'current' ? '–í –ø—Ä–æ—Ü–µ—Å—Å–µ' : '–ì–æ—Ç–æ–≤–æ' %>
          </span>
        </td>
        <td><%= task.due_date || '-' %></td>
        <td>
          <% if (task.attachments && task.attachments.length > 0) { %>
            <div class="attachment-list">
              <% task.attachments.forEach(att => { %>
                <a href="/tasks/<%= task.id %>/attachments/<%= att.id %>" target="_blank">
                  üìé <%= att.original_name %>
                </a>
              <% }) %>
            </div>
          <% } %>
        </td>
        <td>
          <a class="btn" href="/tasks/<%= task.id %>/edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
          <form
            action="/tasks/<%= task.id %>?_method=DELETE"
            method="POST"
            style="display: inline"
          >
            <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
          </form>
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
<% } %>
